-- ==========================================================
-- Lua 5.1 完整基础语法全景展示
-- ==========================================================

-----------------------------------------------------------
-- 1. 变量与数据类型
-----------------------------------------------------------
local num = 100                 -- Number (数值，Lua 5.1 不分整型和浮点型)
local str = "Hello Lua"         -- String (字符串)
local bool = true               -- Boolean (布尔)
local empty = nil               -- Nil (表示空，常用于删除变量或表元素)

-- 局部变量 vs 全局变量
local local_var = "我只在这个文件有效"
global_var = "我在哪都能被访问"  -- 不加 local 关键字即为全局变量

-----------------------------------------------------------
-- 2. 表 (Table) - Lua 唯一的复合数据结构
-----------------------------------------------------------
-- 数组用法 (索引从 1 开始)
local fruits = {"Apple", "Banana", "Orange"}

-- 字典/对象用法 (键值对)
local player = {
    id = 1001,
    name = "PlayerOne",
    is_online = true
}

-- 混合用法
player["level"] = 10  -- 动态赋值
table.insert(fruits, "Pear") -- 使用内置库插入数组元素

-----------------------------------------------------------
-- 3. 运算符
-----------------------------------------------------------
local a = 10 + 5    -- 加 (+), 减 (-), 乘 (*), 除 (/), 取余 (%), 指数 (^)
local b = "Hi " .. "Gemini" -- 字符串拼接使用 ".."
local c = (10 ~= 5) -- 不等于使用 "~="，等于使用 "=="

-----------------------------------------------------------
-- 4. 流程控制
-----------------------------------------------------------
print("--- [逻辑判断与循环] ---")

-- If 判断
if player.id == 1001 and player.is_online then
    print(player.name .. " 在线！")
elseif player.id == 0 then
    print("系统管理员")
else
    print("未知用户")
end

-- For 循环 (数值型)
-- 格式：从 1 到 3，步长为 1
for i = 1, 3, 1 do
    print("循环次数: " .. i)
end

-- For 循环 (泛型 - 遍历表)
-- ipairs 用于遍历连续数组
for index, value in ipairs(fruits) do
    print("水果列表索引: " .. index .. " 内容: " .. value)
end

-- pairs 用于遍历字典或不连续的表
for key, val in pairs(player) do
    print("玩家属性 - 键: " .. key .. " 值: " .. tostring(val))
end

-----------------------------------------------------------
-- 5. 函数 (Function)
-----------------------------------------------------------
print("--- [函数演示] ---")

-- 支持多返回值的函数
local function calculate(x, y)
    local sum = x + y
    local diff = x - y
    return sum, diff -- Lua 特色：一次返回多个值
end

-- 接收返回值
local s, d = calculate(20, 10)
print("20 + 10 = " .. s)
print("20 - 10 = " .. d)

-- 匿名函数
local multiply = function(n) return n * 2 end
print("5 乘以 2 是: " .. multiply(5))

-----------------------------------------------------------
-- 6. 作用域演示
-----------------------------------------------------------
do
    local block_var = "我只在这个 do-end 块里生效"
    print(block_var)
end
-- print(block_var) -- 如果取消注释，这里会打印 nil，因为变量已失效

print("\n>>> 恭喜！你已运行完 Lua 基础语法全家桶。")